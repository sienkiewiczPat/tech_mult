<html>

<head>
    <meta charset="utf-8">
    <title>Ä†wiczenie 2 Zadanie 5 i Zadanie 6</title>
</head>

<body>
    <canvas id="canvas" width="1200" height="630" style="border:1px solid #00bcd4"></canvas>

    <script type="text/javascript">
        let currentFrame = 0;
        let framesMax = 3;
        let frameWidth = 190;
        let frameHeight = 155;
        const sprite = new Image();
        sprite.src = "flying_dragon.png";

        var ctx = document.getElementById("canvas").getContext("2d");
        canvas = document.createElement("canvas");
        img = new Image();
        imgWidth = 0;
        imgHeight = 0;
        canvasWidth = 1200;
        canvasHeight = 630;
        currentPosition = 0;
        speed = 2;

        img.src = "lake.jpg";
        img.onload = loadImage;

        function loadImage() {
            imgWidth = img.width;
            imgHeight = img.height;
            canvas.width = imgWidth;
            canvas.height = imgHeight;
            render();
        }

        function render() {
            ctx.clearRect(0, 0, canvasWidth, canvasHeight);

            if (currentPosition >= canvasWidth) {
                console.log(currentPosition);
                currentPosition = 0;
            }

            currentPosition += speed;
            ctx.drawImage(img, canvasWidth - currentPosition, 0, currentPosition, imgHeight, 0, 0, currentPosition, imgHeight);
            ctx.drawImage(img, currentPosition, 0, imgWidth, imgHeight);


            if (currentFrame > framesMax - 1) {
                currentFrame = 0;
            }
            currentFrame++;

            const cutX = (currentFrame - 1) * frameWidth;
            const drawPosX = canvas.width / 2 - 60;
            const drawPosY = 40;

            ctx.drawImage(sprite, cutX, 0, frameWidth, frameHeight, drawPosX, drawPosY, frameWidth, frameHeight);

            setTimeout(function () { render(); }, 4);
        }
    </script>
</body>

</html>